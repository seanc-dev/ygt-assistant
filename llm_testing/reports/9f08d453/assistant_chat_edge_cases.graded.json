{
  "evaluation": {
    "scores": {
      "factual": 0.0,
      "clarity": 0.0,
      "safety": 0.0
    },
    "ok": false,
    "rationale": "snapshot_mismatch: --- stored\n+++ current\n@@ -24,7 +24,10 @@\n           }\n         ]\n       },\n-      \"status\": 200\n+      \"status\": 200,\n+      \"request_body\": {\n+        \"text\": \"unknown command\"\n+      }\n     },\n    ",
    "snapshot": {
      "match": false,
      "diff": "--- stored\n+++ current\n@@ -24,7 +24,10 @@\n           }\n         ]\n       },\n-      \"status\": 200\n+      \"status\": 200,\n+      \"request_body\": {\n+        \"text\": \"unknown command\"\n+      }\n     },\n     {\n       \"endpoint\": \"/chat\",\n@@ -37,7 +40,10 @@\n           }\n         ]\n       },\n-      \"status\": 200\n+      \"status\": 200,\n+      \"request_body\": {\n+        \"text\": \"approve invalid-id\"\n+      }\n     },\n     {\n       \"endpoint\": \"/chat\",\n@@ -58,7 +64,10 @@\n           }\n         ]\n       },\n-      \"status\": 200\n+      \"status\": 200,\n+      \"request_body\": {\n+        \"text\": \"scan\"\n+      }\n     },\n     {\n       \"endpoint\": \"/chat\",\n@@ -79,7 +88,10 @@\n           }\n         ]\n       },\n-      \"status\": 200\n+      \"status\": 200,\n+      \"request_body\": {\n+        \"text\": \"scan\"\n+      }\n     },\n     {\n       \"endpoint\": \"/chat\",\n@@ -100,7 +112,10 @@\n           }\n         ]\n       },\n-      \"status\": 200\n+      \"status\": 200,\n+      \"request_body\": {\n+        \"text\": \"scan agenda\"\n+      }\n     },\n     {\n       \"endpoint\": \"/chat\",\n@@ -113,7 +128,10 @@\n           }\n         ]\n       },\n-      \"status\": 200\n+      \"status\": 200,\n+      \"request_body\": {\n+        \"text\": \"skip appr-1\"\n+      }\n     }\n   ],\n   \"text\": \"{'ok': True, 'cleared': {'approvals': True, 'history': True, 'queue': True, 'settings': False}}\\n{'messages': [{'role': 'assistant', 'content': \\\"Unknown command. Try: 'scan', 'approve <id>', or 'skip <id>'.\\\"}]}\\n{'messages': [{'role': 'assistant', 'content': 'Not found.'}]}\\n{'messages': [{'role': 'assistant', 'content': \\\"Proposed 1 approval(s). Reply 'approve <id>' or 'skip <id>'.\\\"}], 'approvals': [{'id': 'appr-1', 'title': 'Follow up on top email', 'kind': 'email', 'status': 'proposed'}]}\\n{'messages': [{'role': 'assistant', 'content': \\\"Proposed 1 approval(s). Reply 'approve <id>' or 'skip <id>'.\\\"}], 'approvals': [{'id': 'appr-1', 'title': 'Follow up on top email', 'kind': 'email', 'status': 'proposed'}]}\\n{'messages': [{'role': 'assistant', 'content': \\\"Proposed 1 approval(s). Reply 'approve <id>' or 'skip <id>'.\\\"}], 'approvals': [{'id': 'appr-1', 'title': 'Follow up on top email', 'kind': 'email', 'status': 'proposed'}]}\\n{'messages': [{'role': 'assistant', 'content': 'Skipped appr-1.'}]}\"\n",
      "normalized": {
        "scenario": "assistant_chat_edge_cases",
        "steps": [
          {
            "action": "reset_state",
            "response": {
              "ok": true,
              "cleared": {
                "approvals": true,
                "history": true,
                "queue": true,
                "settings": false
              }
            }
          },
          {
            "endpoint": "/chat",
            "method": "POST",
            "response": {
              "messages": [
                {
                  "role": "assistant",
                  "content": "Unknown command. Try: 'scan', 'approve <id>', or 'skip <id>'."
                }
              ]
            },
            "status": 200,
            "request_body": {
              "text": "unknown command"
            }
          },
          {
            "endpoint": "/chat",
            "method": "POST",
            "response": {
              "messages": [
                {
                  "role": "assistant",
                  "content": "Not found."
                }
              ]
            },
            "status": 200,
            "request_body": {
              "text": "approve invalid-id"
            }
          },
          {
            "endpoint": "/chat",
            "method": "POST",
            "response": {
              "messages": [
                {
                  "role": "assistant",
                  "content": "Proposed 1 approval(s). Reply 'approve <id>' or 'skip <id>'."
                }
              ],
              "approvals": [
                {
                  "id": "appr-1",
                  "title": "Follow up on top email",
                  "kind": "email",
                  "status": "proposed"
                }
              ]
            },
            "status": 200,
            "request_body": {
              "text": "scan"
            }
          },
          {
            "endpoint": "/chat",
            "method": "POST",
            "response": {
              "messages": [
                {
                  "role": "assistant",
                  "content": "Proposed 1 approval(s). Reply 'approve <id>' or 'skip <id>'."
                }
              ],
              "approvals": [
                {
                  "id": "appr-1",
                  "title": "Follow up on top email",
                  "kind": "email",
                  "status": "proposed"
                }
              ]
            },
            "status": 200,
            "request_body": {
              "text": "scan"
            }
          },
          {
            "endpoint": "/chat",
            "method": "POST",
            "response": {
              "messages": [
                {
                  "role": "assistant",
                  "content": "Proposed 1 approval(s). Reply 'approve <id>' or 'skip <id>'."
                }
              ],
              "approvals": [
                {
                  "id": "appr-1",
                  "title": "Follow up on top email",
                  "kind": "email",
                  "status": "proposed"
                }
              ]
            },
            "status": 200,
            "request_body": {
              "text": "scan agenda"
            }
          },
          {
            "endpoint": "/chat",
            "method": "POST",
            "response": {
              "messages": [
                {
                  "role": "assistant",
                  "content": "Skipped appr-1."
                }
              ]
            },
            "status": 200,
            "request_body": {
              "text": "skip appr-1"
            }
          }
        ],
        "text": "{'ok': True, 'cleared': {'approvals': True, 'history': True, 'queue': True, 'settings': False}}\n{'messages': [{'role': 'assistant', 'content': \"Unknown command. Try: 'scan', 'approve <id>', or 'skip <id>'.\"}]}\n{'messages': [{'role': 'assistant', 'content': 'Not found.'}]}\n{'messages': [{'role': 'assistant', 'content': \"Proposed 1 approval(s). Reply 'approve <id>' or 'skip <id>'.\"}], 'approvals': [{'id': 'appr-1', 'title': 'Follow up on top email', 'kind': 'email', 'status': 'proposed'}]}\n{'messages': [{'role': 'assistant', 'content': \"Proposed 1 approval(s). Reply 'approve <id>' or 'skip <id>'.\"}], 'approvals': [{'id': 'appr-1', 'title': 'Follow up on top email', 'kind': 'email', 'status': 'proposed'}]}\n{'messages': [{'role': 'assistant', 'content': \"Proposed 1 approval(s). Reply 'approve <id>' or 'skip <id>'.\"}], 'approvals': [{'id': 'appr-1', 'title': 'Follow up on top email', 'kind': 'email', 'status': 'proposed'}]}\n{'messages': [{'role': 'assistant', 'content': 'Skipped appr-1.'}]}"
      }
    }
  }
}