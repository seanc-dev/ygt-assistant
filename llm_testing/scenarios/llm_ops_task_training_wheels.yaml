name: llm_ops_task_training_wheels
mode: mock
steps:
  - action: reset_state
  - action: http
    method: POST
    url: /dev/workroom/seed
    expect:
      status: 200
      jsonpath:
        ok: true
  - action: http
    method: PUT
    url: /api/settings
    json:
      trust_level: "training_wheels"
    expect:
      status: 200
  - action: http
    method: GET
    url: /api/workroom/tree
    expect:
      status: 200
    extract:
      task_id: "tree.0.children.0.id"
  - action: http
    method: POST
    url: /api/workroom/tasks/<task_id>/assistant-suggest
    json:
      message: "Can you help me update this task status and create a follow-up?"
    expect:
      status: 200
      contains:
        - "operations"
        - "applied"
        - "pending"
  - action: http
    method: POST
    url: /api/workroom/tasks/<task_id>/assistant-approve
    json:
      operation:
        op: "update_task_status"
        params:
          task_id: "<task_id>"
          status: "doing"
    expect:
      status: 200
      contains:
        - "ok"
expectations:
  must_contain:
    - "operations"
    - "applied"
    - "pending"
  must_not_contain:
    - "error"
  function_calling:
    # Assess that LLM correctly generates operations
    check_operations: true
    # In training_wheels mode, operations should be in pending (not applied)
    expected_behavior: "operations_should_be_pending"
    # Snapshot operation responses (deterministic - generated by our code, not LLM)
    snapshot_operations: "llm_ops_task_training_wheels_operations.json"
